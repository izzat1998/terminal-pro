# Container Placement Business Flow - Complete Specification

> **Version 2.0** | January 2026
> **Status:** Final
> **Notification Strategy:** Telegram-based (no WebSocket for control room)

---

## Executive Summary

This document provides a **crystal-clear specification** of the container placement workflow in the MTT Container Terminal system. The workflow follows 5 key stages from container entry to placement confirmation.

### Key Decision: Telegram for All Notifications

Instead of implementing WebSocket real-time updates for the control room, **all notifications flow through Telegram Bot**. This simplifies architecture and leverages existing infrastructure.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    NOTIFICATION ARCHITECTURE                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   BEFORE (Complex):                                                     â”‚
â”‚   Control Room â†â”€â”€ WebSocket â”€â”€â”€â”€ Server â”€â”€â”€â”€ Telegram â”€â”€â†’ Manager     â”‚
â”‚                                                                         â”‚
â”‚   AFTER (Simplified):                                                   â”‚
â”‚   Control Room â†â”€â”€ Telegram â”€â”€â”€â”€â”€ Server â”€â”€â”€â”€â”€ Telegram â”€â”€â†’ Manager    â”‚
â”‚                      Bot                         Bot                    â”‚
â”‚                                                                         â”‚
â”‚   Benefits:                                                             â”‚
â”‚   âœ“ No Django Channels setup needed                                    â”‚
â”‚   âœ“ Single notification system to maintain                             â”‚
â”‚   âœ“ Works on any device (desktop/mobile)                               â”‚
â”‚   âœ“ Notifications even when browser is closed                          â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Table of Contents

1. [Business Flow Overview](#1-business-flow-overview)
2. [Step 1: Container Entry](#2-step-1-container-entry)
3. [Step 2: Operator Position Decision (3D View)](#3-step-2-operator-position-decision-3d-view)
4. [Step 3: Work Order to Vehicle Manager](#4-step-3-work-order-to-vehicle-manager)
5. [Step 4: Manager Places Container](#5-step-4-manager-places-container)
6. [Step 5: Operator Receives Confirmation](#6-step-5-operator-receives-confirmation)
7. [Data Models](#7-data-models)
8. [API Endpoints](#8-api-endpoints)
9. [Telegram Notification Templates](#9-telegram-notification-templates)
10. [Error Handling](#10-error-handling)
11. [Implementation Checklist](#11-implementation-checklist)

---

## 1. Business Flow Overview

### Visual Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CONTAINER PLACEMENT WORKFLOW                             â”‚
â”‚                          (5 Core Steps)                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   STEP 1              STEP 2              STEP 3              STEP 4              STEP 5
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GATE     â”‚      â”‚ CONTROL ROOM â”‚      â”‚ TELEGRAM â”‚      â”‚ MANAGER  â”‚      â”‚ CONTROL  â”‚
â”‚ ENTRY    â”‚â”€â”€â”€â”€â”€â–¶â”‚ 3D DECISION  â”‚â”€â”€â”€â”€â”€â–¶â”‚ DISPATCH â”‚â”€â”€â”€â”€â”€â–¶â”‚ EXECUTES â”‚â”€â”€â”€â”€â”€â–¶â”‚ NOTIFIED â”‚
â”‚          â”‚      â”‚              â”‚      â”‚          â”‚      â”‚          â”‚      â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                   â”‚                   â”‚                   â”‚                  â”‚
     â–¼                   â–¼                   â–¼                   â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Container â”‚      â”‚ Position     â”‚      â”‚ Manager  â”‚      â”‚ Container â”‚      â”‚Telegram  â”‚
â”‚Entry     â”‚      â”‚ selected via â”‚      â”‚ receives â”‚      â”‚ placed,   â”‚      â”‚notifies  â”‚
â”‚created   â”‚      â”‚ 3D terminal  â”‚      â”‚ work     â”‚      â”‚ photo     â”‚      â”‚operator  â”‚
â”‚in DB     â”‚      â”‚ view         â”‚      â”‚ order    â”‚      â”‚ uploaded  â”‚      â”‚of result â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   ACTORS:           ACTORS:              ACTORS:           ACTORS:           ACTORS:
   â€¢ Gate Op.        â€¢ Control Room       â€¢ System          â€¢ Manager         â€¢ System
   â€¢ System          â€¢ System             â€¢ Manager         â€¢ System          â€¢ Control Op.
```

### Actor Definitions

| Actor | Location | Primary Tool | Telegram Role |
|-------|----------|--------------|---------------|
| **Gate Operator** | Gate booth | API / Web Form | Receives entry confirmations |
| **Control Room Operator** | Control room | Vue 3D Dashboard | Receives placement confirmations |
| **Vehicle Manager** | Yard (mobile) | Telegram Mini App | Receives work orders, sends completion |
| **System** | Server | Automated | Sends all Telegram notifications |

---

## 2. Step 1: Container Entry

### Purpose
Register a new container entering the terminal, capturing all relevant data.

### Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         STEP 1: CONTAINER ENTRY                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   TRUCK ARRIVES                      GATE OPERATOR                        SYSTEM
       â”‚                                   â”‚                                  â”‚
       â”‚                                   â”‚                                  â”‚
       â”‚â”€â”€â”€ Shows container â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                                  â”‚
       â”‚                                   â”‚                                  â”‚
       â”‚                                   â”‚â”€â”€ Enter container data â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
       â”‚                                   â”‚   â€¢ Container number             â”‚
       â”‚                                   â”‚   â€¢ Size (20/40/45ft)            â”‚
       â”‚                                   â”‚   â€¢ Status (LADEN/EMPTY)         â”‚
       â”‚                                   â”‚   â€¢ Transport type               â”‚
       â”‚                                   â”‚                                  â”‚
       â”‚                                   â”‚                                  â”‚
       â”‚                                   â”‚â—€â”€â”€ Validate ISO format â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚                                   â”‚â—€â”€â”€ Check for duplicates â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚                                   â”‚â—€â”€â”€ Create ContainerEntry â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚                                   â”‚                                  â”‚
       â”‚                                   â”‚                                  â”‚
       â”‚â—€â”€â”€ Entry barrier opens â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                                  â”‚
       â”‚                                   â”‚                                  â”‚
       â”‚                                   â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                                   â”‚              â”‚   Telegram Bot    â”‚
       â”‚                                   â”‚              â”‚                   â”‚
       â”‚                                   â”‚              â”‚ "ğŸ“¦ ĞĞ¾Ğ²Ñ‹Ğ¹ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€â”‚
       â”‚                                   â”‚              â”‚  MSCU1234567      â”‚
       â”‚                                   â”‚              â”‚  Ğ¾Ğ¶Ğ¸Ğ´Ğ°ĞµÑ‚          â”‚
       â”‚                                   â”‚              â”‚  Ñ€Ğ°Ğ·Ğ¼ĞµÑ‰ĞµĞ½Ğ¸Ñ"      â”‚
       â”‚                                   â”‚              â”‚                   â”‚
       â”‚                                   â”‚              â”‚ â†’ Control Room    â”‚
       â”‚                                   â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### API Endpoint

```yaml
POST /api/terminal/entries/

Request:
  container_number: "MSCU1234567"    # Required, ISO 6346 format
  status: "LADEN"                    # Required: LADEN | EMPTY
  transport_type: "TRUCK"            # Required: TRUCK | WAGON | TRAIN
  weight_kg: 28500                   # Optional, for laden containers
  customer_id: 15                    # Optional, FK to Company
  seal_number: "ABC123456"           # Optional

Response:
  success: true
  data:
    id: 456
    container_number: "MSCU1234567"
    status: "LADEN"
    transport_type: "TRUCK"
    entry_time: "2026-01-16T10:30:00Z"
    location: null                   # No position yet
    position: null                   # No ContainerPosition yet
```

### Validation Rules

| Rule | Error Code | Russian Message |
|------|------------|-----------------|
| Container format: 4 letters + 7 digits | `INVALID_CONTAINER_FORMAT` | ĞĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ° |
| Container not already on terminal | `CONTAINER_ALREADY_ON_TERMINAL` | ĞšĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ ÑƒĞ¶Ğµ Ğ½Ğ° Ñ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ğ»Ğµ |
| Weight required for LADEN status | `WEIGHT_REQUIRED_FOR_LADEN` | Ğ£ĞºĞ°Ğ¶Ğ¸Ñ‚Ğµ Ğ²ĞµÑ Ğ´Ğ»Ñ Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ° |

### Database Changes

```python
# ContainerEntry created with:
ContainerEntry(
    container_number="MSCU1234567",
    status="LADEN",
    transport_type="TRUCK",
    entry_time=timezone.now(),
    recorded_by=current_user,
    location=None,          # Will be set after placement
    # position relation will be created in Step 4
)
```

### Telegram Notification (to Control Room)

```
ğŸ“¦ ĞĞĞ’Ğ«Ğ™ ĞšĞĞĞ¢Ğ•Ğ™ĞĞ•Ğ  ĞĞ Ğ¢Ğ•Ğ ĞœĞ˜ĞĞĞ›Ğ•

ĞĞ¾Ğ¼ĞµÑ€: `MSCU1234567`
Ğ Ğ°Ğ·Ğ¼ĞµÑ€: 40ft High Cube
Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ: Ğ“Ğ Ğ£Ğ–Ğ•ĞĞ«Ğ™ (28.5 Ñ‚)
Ğ¢Ñ€Ğ°Ğ½ÑĞ¿Ğ¾Ñ€Ñ‚: Ğ“Ñ€ÑƒĞ·Ğ¾Ğ²Ğ¸Ğº

â³ ĞĞ¶Ğ¸Ğ´Ğ°ĞµÑ‚ Ñ€Ğ°Ğ·Ğ¼ĞµÑ‰ĞµĞ½Ğ¸Ñ

[ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ]
```

---

## 3. Step 2: Operator Position Decision (3D View)

### Purpose
Control room operator views the terminal in 3D, decides where to place the container, and creates a work order.

### Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    STEP 2: OPERATOR POSITION DECISION                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                         CONTROL ROOM OPERATOR
                                  â”‚
                                  â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                             â”‚                             â”‚
    â”‚                             â–¼                             â”‚
    â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
    â”‚        â”‚         3D TERMINAL VIEW            â”‚           â”‚
    â”‚        â”‚                                     â”‚           â”‚
    â”‚        â”‚    â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”       â”‚           â”‚
    â”‚        â”‚    â”‚Zone â”‚Zone â”‚Zone â”‚Zone â”‚       â”‚           â”‚
    â”‚        â”‚    â”‚  A  â”‚  B  â”‚  C  â”‚  D  â”‚       â”‚           â”‚
    â”‚        â”‚    â”‚     â”‚     â”‚     â”‚     â”‚       â”‚           â”‚
    â”‚        â”‚    â”‚ â–‘â–‘â–‘ â”‚ â–ˆâ–ˆâ–‘ â”‚ â–‘â–ˆâ–ˆ â”‚ â–‘â–‘â–‘ â”‚       â”‚           â”‚
    â”‚        â”‚    â”‚ â–‘â–‘â–ˆ â”‚ â–ˆâ–ˆâ–ˆ â”‚ â–ˆâ–ˆâ–‘ â”‚ â–‘â–‘â–‘ â”‚       â”‚           â”‚
    â”‚        â”‚    â”‚ â–ˆâ–ˆâ–ˆ â”‚ â–ˆâ–ˆâ–ˆ â”‚ â–ˆâ–ˆâ–ˆ â”‚ â–‘â–‘â–ˆ â”‚       â”‚           â”‚
    â”‚        â”‚    â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜       â”‚           â”‚
    â”‚        â”‚                                     â”‚           â”‚
    â”‚        â”‚    [Unplaced: 3 containers]        â”‚           â”‚
    â”‚        â”‚    â€¢ MSCU1234567 (40HC, LADEN)     â”‚           â”‚
    â”‚        â”‚    â€¢ TCKU9876543 (20ft, EMPTY)     â”‚           â”‚
    â”‚        â”‚    â€¢ HLCU5555555 (40ft, LADEN)     â”‚           â”‚
    â”‚        â”‚                                     â”‚           â”‚
    â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
    â”‚                             â”‚                             â”‚
    â”‚                             â”‚                             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                           â”‚
                    â–¼                           â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ AUTO-SUGGEST  â”‚           â”‚ MANUAL SELECT â”‚
           â”‚               â”‚           â”‚               â”‚
           â”‚ System        â”‚           â”‚ Operator      â”‚
           â”‚ recommends    â”‚           â”‚ clicks on     â”‚
           â”‚ optimal       â”‚           â”‚ specific      â”‚
           â”‚ position      â”‚           â”‚ position in   â”‚
           â”‚               â”‚           â”‚ 3D view       â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚                           â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  VALIDATE POSITION  â”‚
                    â”‚                     â”‚
                    â”‚ âœ“ Row segregation   â”‚
                    â”‚ âœ“ Size compatible   â”‚
                    â”‚ âœ“ Weight rules      â”‚
                    â”‚ âœ“ Has support below â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  CREATE WORK ORDER  â”‚
                    â”‚                     â”‚
                    â”‚ Target: A-R03-B15-T2â”‚
                    â”‚ Priority: MEDIUM    â”‚
                    â”‚ Assign to: [Manager]â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3D Coordinate System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        COORDINATE FORMAT: A-R03-B15-T2-A                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    A    -   R03   -   B15   -   T2   -   A
    â”‚        â”‚         â”‚        â”‚        â”‚
    â”‚        â”‚         â”‚        â”‚        â””â”€ Sub-slot (A=Fore, B=Aft)
    â”‚        â”‚         â”‚        â”‚           Only for 20ft containers
    â”‚        â”‚         â”‚        â”‚
    â”‚        â”‚         â”‚        â””â”€ Tier (T1-T4)
    â”‚        â”‚         â”‚           Height level, T1 = ground
    â”‚        â”‚         â”‚
    â”‚        â”‚         â””â”€ Bay (B01-B10)
    â”‚        â”‚            Column position
    â”‚        â”‚
    â”‚        â””â”€ Row (R01-R10)
    â”‚           R01-R05: 40ft containers
    â”‚           R06-R10: 20ft containers
    â”‚
    â””â”€ Zone (A-E)
       Area of the yard


    VISUAL REPRESENTATION (Zone A):

    Top-Down View:                    Side View (Row 3):

         B01  B02  B03  B04  B05         B01  B02  B03  B04  B05
       â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”      T4â”‚    â”‚    â”‚    â”‚    â”‚
    R01â”‚ 2  â”‚ 3  â”‚ 1  â”‚    â”‚ 2  â”‚      T3â”‚ â–ˆâ–ˆ â”‚    â”‚    â”‚    â”‚
       â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤      T2â”‚ â–ˆâ–ˆ â”‚ â–ˆâ–ˆ â”‚ ğŸ¯ â”‚    â”‚  â† Target
    R02â”‚ 1  â”‚ 2  â”‚ 3  â”‚ 2  â”‚ 1  â”‚      T1â”‚ â–ˆâ–ˆ â”‚ â–ˆâ–ˆ â”‚ â–ˆâ–ˆ â”‚ â–ˆâ–ˆ â”‚
       â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â•‹â•â•â•â•â•‹â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤        â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
    R03â”‚ 2  â”‚ 1 â•‘ ğŸ¯ â•‘ 2  â”‚    â”‚
       â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â•‹â•â•â•â•â•‹â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤        Legend:
    R04â”‚ 3  â”‚ 2  â”‚ 2  â”‚ 1  â”‚ 1  â”‚        â–ˆâ–ˆ = Container
       â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜        ğŸ¯ = Target position
                                         Numbers = Stack height
    Legend:
    Numbers = Stack height (max 4)
    ğŸ¯ = Target position (A-R03-B03-T2)
```

### TOS Stacking Rules (Enforced)

| Rule | Description | Error Message |
|------|-------------|---------------|
| **Row Segregation** | 40ft in R01-R05, 20ft in R06-R10 | Ğ ÑĞ´ Ğ½Ğµ ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ñƒ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ° |
| **Size Compatibility** | Cannot place 40ft on single 20ft | ĞĞµĞ»ÑŒĞ·Ñ ÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ÑŒ 40ft Ğ½Ğ° 20ft |
| **Weight Distribution** | LADEN cannot be placed on EMPTY | ĞĞµĞ»ÑŒĞ·Ñ ÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ñ‹Ğ¹ Ğ½Ğ° Ğ¿ÑƒÑÑ‚Ğ¾Ğ¹ |
| **Stacking Support** | Must have container below (except T1) | ĞĞµÑ‚ Ğ¾Ğ¿Ğ¾Ñ€Ñ‹ ÑĞ½Ğ¸Ğ·Ñƒ |
| **Max Height** | Maximum 4 tiers | ĞŸÑ€ĞµĞ²Ñ‹ÑˆĞµĞ½Ğ° Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ²Ñ‹ÑĞ¾Ñ‚Ğ° |

### API Endpoints

#### Get Unplaced Containers
```yaml
GET /api/terminal/placement/unplaced/

Response:
  success: true
  data:
    - id: 456
      container_number: "MSCU1234567"
      size: "40"
      status: "LADEN"
      entry_time: "2026-01-16T10:30:00Z"
      waiting_minutes: 15
```

#### Get Position Suggestions
```yaml
POST /api/terminal/placement/suggest/

Request:
  container_entry_id: 456
  zone_preference: "A"              # Optional

Response:
  success: true
  data:
    primary:
      zone: "A"
      row: 3
      bay: 15
      tier: 2
      sub_slot: "A"
      display_code: "A-R03-B15-T2-A"
      reason: "Consolidation with same customer"
    alternatives:
      - zone: "A", row: 4, bay: 12, tier: 1, ...
      - zone: "B", row: 2, bay: 8, tier: 3, ...
      - zone: "A", row: 3, bay: 16, tier: 1, ...
```

#### Validate Position
```yaml
POST /api/terminal/placement/validate/

Request:
  container_entry_id: 456
  position:
    zone: "A"
    row: 3
    bay: 15
    tier: 2
    sub_slot: "A"

Response:
  success: true
  data:
    valid: true
    warnings: []

# OR if invalid:
Response:
  success: false
  error:
    code: "INVALID_ROW_FOR_SIZE"
    message: "Ğ ÑĞ´ Ğ½Ğµ ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ñƒ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°"
```

---

## 4. Step 3: Work Order to Vehicle Manager

### Purpose
Create a work order with the target position and dispatch it to a vehicle manager via Telegram.

### Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     STEP 3: WORK ORDER DISPATCH                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    CONTROL ROOM                         SYSTEM                      MANAGER
         â”‚                                  â”‚                            â”‚
         â”‚                                  â”‚                            â”‚
         â”‚â”€â”€ Create Work Order â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                            â”‚
         â”‚   â€¢ Container: MSCU1234567       â”‚                            â”‚
         â”‚   â€¢ Position: A-R03-B15-T2       â”‚                            â”‚
         â”‚   â€¢ Priority: MEDIUM             â”‚                            â”‚
         â”‚   â€¢ Assign to: Manager Ivan      â”‚                            â”‚
         â”‚                                  â”‚                            â”‚
         â”‚                                  â”‚                            â”‚
         â”‚                                  â”‚â”€â”€ Calculate SLA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
         â”‚                                  â”‚   MEDIUM = 60 min          â”‚
         â”‚                                  â”‚                            â”‚
         â”‚                                  â”‚                            â”‚
         â”‚â—€â”€â”€ Work Order Created â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                            â”‚
         â”‚    ID: WO-20260116-0023          â”‚                            â”‚
         â”‚    Status: ASSIGNED              â”‚                            â”‚
         â”‚                                  â”‚                            â”‚
         â”‚                                  â”‚                            â”‚
         â”‚                                  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                  â”‚â”€â”€â”€â”€â”€â”‚  TELEGRAM BOT        â”‚
         â”‚                                  â”‚     â”‚                      â”‚
         â”‚                                  â”‚     â”‚  ğŸ“‹ ĞĞĞ’Ğ«Ğ™ ĞĞĞ Ğ¯Ğ”      â”‚
         â”‚                                  â”‚     â”‚                      â”‚
         â”‚                                  â”‚     â”‚  `MSCU1234567`       â”‚
         â”‚                                  â”‚     â”‚  â†’ `A-R03-B15-T2`    â”‚
         â”‚                                  â”‚     â”‚                      â”‚
         â”‚                                  â”‚     â”‚  40ft Ğ“Ğ Ğ£Ğ–Ğ•ĞĞ«Ğ™       â”‚
         â”‚                                  â”‚     â”‚  â± 60 Ğ¼Ğ¸Ğ½            â”‚
         â”‚                                  â”‚     â”‚                      â”‚
         â”‚                                  â”‚     â”‚  [ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Mini App]  â”‚â”€â”€â–¶â”‚
         â”‚                                  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
         â”‚                                  â”‚                                â”‚
         â”‚                                  â”‚                                â”‚
         â”‚                                  â”‚â—€â”€â”€ Manager opens Mini App â”€â”€â”€â”€â”€â”‚
         â”‚                                  â”‚                                â”‚
```

### Work Order Status Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        WORK ORDER STATE MACHINE                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                           create()
                              â”‚
                              â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚   PENDING    â”‚   â† Created, not yet assigned
                       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ assign(manager)
                              â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚   ASSIGNED   â”‚   â† Telegram notification sent
                       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ accept() [Manager clicks "ĞŸÑ€Ğ¸Ğ½ÑÑ‚ÑŒ"]
                              â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚   ACCEPTED   â”‚   â† Manager acknowledged
                       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ start() [Manager clicks "ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ"]
                              â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚ IN_PROGRESS  â”‚   â† Manager navigating to location
                       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ complete() [Manager clicks "Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾"]
                              â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚  COMPLETED   â”‚   â† Awaiting verification
                       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ verify()
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼                   â–¼
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚ VERIFIED â”‚        â”‚  FAILED  â”‚
             â”‚    âœ“     â”‚        â”‚    âœ—     â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### SLA Configuration

| Priority | Time Limit | Escalation Warning |
|----------|------------|-------------------|
| `URGENT` | 15 min | At 5 min remaining |
| `HIGH` | 30 min | At 10 min remaining |
| `MEDIUM` | 60 min | At 20 min remaining |
| `LOW` | 120 min | At 40 min remaining |

### API Endpoint

```yaml
POST /api/terminal/work-orders/

Request:
  container_entry_id: 456
  target_zone: "A"
  target_row: 3
  target_bay: 15
  target_tier: 2
  target_sub_slot: "A"
  priority: "MEDIUM"
  assigned_to_id: 12              # Manager's user ID

Response:
  success: true
  data:
    id: 789
    order_number: "WO-20260116-0023"
    status: "ASSIGNED"
    priority: "MEDIUM"
    container_entry:
      id: 456
      container_number: "MSCU1234567"
      size: "40"
      status: "LADEN"
    target_position:
      zone: "A"
      row: 3
      bay: 15
      tier: 2
      sub_slot: "A"
      display_code: "A-R03-B15-T2-A"
    assigned_to:
      id: 12
      name: "Ivan Petrov"
      telegram_id: 123456789
    sla_deadline: "2026-01-16T11:30:00Z"
    created_at: "2026-01-16T10:30:00Z"
```

---

## 5. Step 4: Manager Places Container

### Purpose
Vehicle manager receives work order in Telegram Mini App, navigates to location, places container, and confirms completion with photo.

### Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      STEP 4: MANAGER PLACEMENT                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    MANAGER'S TELEGRAM MINI APP
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Step 4.1: VIEW WORK ORDER LIST                                          â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                                                                          â”‚
    â”‚    ğŸ“‹ ĞœĞ¾Ğ¸ Ğ½Ğ°Ñ€ÑĞ´Ñ‹                              [ğŸ”„ ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ]              â”‚
    â”‚    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”‚
    â”‚                                                                          â”‚
    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
    â”‚    â”‚ ğŸŸ¡ WO-0023 | ĞĞ‘Ğ«Ğ§ĞĞ«Ğ™                   â± 58 Ğ¼Ğ¸Ğ½        â”‚           â”‚
    â”‚    â”‚                                                         â”‚           â”‚
    â”‚    â”‚ ğŸ“¦ MSCU1234567                                         â”‚           â”‚
    â”‚    â”‚ ğŸ“ A-R03-B15-T2   (40ft Ğ“Ğ Ğ£Ğ–Ğ•ĞĞ«Ğ™)                      â”‚           â”‚
    â”‚    â”‚                                                         â”‚           â”‚
    â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚           â”‚
    â”‚    â”‚ â”‚              [ ĞŸĞ Ğ˜ĞĞ¯Ğ¢Ğ¬ ]                            â”‚ â”‚           â”‚
    â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚           â”‚
    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
    â”‚                                                                          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â”‚ Manager taps "ĞŸĞ Ğ˜ĞĞ¯Ğ¢Ğ¬"
                                        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Step 4.2: VIEW PLACEMENT DETAILS                                        â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                                                                          â”‚
    â”‚    â† ĞĞ°Ğ·Ğ°Ğ´            WO-0023                     â± 56:42               â”‚
    â”‚    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”‚
    â”‚                                                                          â”‚
    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
    â”‚    â”‚  ğŸ“¦ MSCU1234567                                        â”‚           â”‚
    â”‚    â”‚  ğŸ“ A-R03-B15-T2                                       â”‚           â”‚
    â”‚    â”‚  ğŸ“ 40ft | âš–ï¸ 28.5Ñ‚ | ğŸ“¦ Ğ“Ğ Ğ£Ğ–Ğ•ĞĞ«Ğ™                      â”‚           â”‚
    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
    â”‚                                                                          â”‚
    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
    â”‚    â”‚  ĞœĞĞ™Ğ”ĞĞ Ğ¡Ğ¥Ğ•ĞœĞĞ¡Ğ˜ (Top-Down)                             â”‚           â”‚
    â”‚    â”‚                                                         â”‚           â”‚
    â”‚    â”‚       B13   B14   B15   B16   B17                       â”‚           â”‚
    â”‚    â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”                        â”‚           â”‚
    â”‚    â”‚   R01â”‚ 2  â”‚ 3  â”‚ 2  â”‚ 1  â”‚    â”‚                        â”‚           â”‚
    â”‚    â”‚      â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤                        â”‚           â”‚
    â”‚    â”‚   R02â”‚ 1  â”‚ 2  â”‚ 3  â”‚ 2  â”‚ 1  â”‚                        â”‚           â”‚
    â”‚    â”‚      â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â•‹â•â•â•â•â•‹â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤                        â”‚           â”‚
    â”‚    â”‚   R03â”‚ 2  â”‚ 1 â•‘ ğŸ¯ â•‘    â”‚    â”‚   â† Ğ¦Ğ•Ğ›Ğ¬               â”‚           â”‚
    â”‚    â”‚      â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â•‹â•â•â•â•â•‹â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤                        â”‚           â”‚
    â”‚    â”‚   R04â”‚ 3  â”‚ 2  â”‚ 2  â”‚ 1  â”‚ 1  â”‚                        â”‚           â”‚
    â”‚    â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜                        â”‚           â”‚
    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
    â”‚                                                                          â”‚
    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
    â”‚    â”‚  ĞĞ ĞšĞĞ Ğ˜ĞĞ˜Ğ¨ (Side View - Row 3)                        â”‚           â”‚
    â”‚    â”‚                                                         â”‚           â”‚
    â”‚    â”‚  T4 â”‚    â”‚    â”‚    â”‚    â”‚    â”‚                         â”‚           â”‚
    â”‚    â”‚  T3 â”‚    â”‚    â”‚    â”‚    â”‚    â”‚                         â”‚           â”‚
    â”‚    â”‚  T2 â”‚    â”‚    â”‚ ğŸ¯ â”‚    â”‚    â”‚  â† Ğ¦Ğ•Ğ›Ğ¬ (ÑÑ€ÑƒÑ 2)        â”‚           â”‚
    â”‚    â”‚  T1 â”‚ â–ˆâ–ˆ â”‚ â–ˆâ–ˆ â”‚ â–ˆâ–ˆ â”‚    â”‚    â”‚  â† ÑĞ½Ğ¸Ğ·Ñƒ MSKU9876543    â”‚           â”‚
    â”‚    â”‚     â”‚B13 â”‚B14 â”‚B15 â”‚B16 â”‚B17 â”‚                         â”‚           â”‚
    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
    â”‚                                                                          â”‚
    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
    â”‚    â”‚          [ ğŸš€ Ğ–ĞĞ™Ğ“Ğ Ğ‘ĞĞ Ğ˜Ğ¨ ]                             â”‚           â”‚
    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
    â”‚                                                                          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â”‚ Manager drives to location
                                        â”‚ Manager taps "Ğ–ĞĞ™Ğ“Ğ Ğ‘ĞĞ Ğ˜Ğ¨"
                                        â”‚ Status: ACCEPTED â†’ IN_PROGRESS
                                        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Step 4.3: CONFIRM PLACEMENT                                             â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                                                                          â”‚
    â”‚    â† ĞĞ°Ğ·Ğ°Ğ´            Ğ¢ĞĞ¡Ğ”Ğ˜ÒšĞ›ĞĞ¨                                         â”‚
    â”‚    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”‚
    â”‚                                                                          â”‚
    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
    â”‚    â”‚                                                         â”‚           â”‚
    â”‚    â”‚              ğŸ“ A-R03-B15-T2                            â”‚           â”‚
    â”‚    â”‚              ğŸ“¦ MSCU1234567                             â”‚           â”‚
    â”‚    â”‚                                                         â”‚           â”‚
    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
    â”‚                                                                          â”‚
    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
    â”‚    â”‚                                                         â”‚           â”‚
    â”‚    â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚           â”‚
    â”‚    â”‚              â”‚                    â”‚                     â”‚           â”‚
    â”‚    â”‚              â”‚   [ ğŸ“· Ğ ĞĞ¡Ğœ ]      â”‚                     â”‚           â”‚
    â”‚    â”‚              â”‚                    â”‚                     â”‚           â”‚
    â”‚    â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚           â”‚
    â”‚    â”‚                                                         â”‚           â”‚
    â”‚    â”‚              Ğ Ğ°ÑĞ¼ Ğ¾Ğ»Ğ¸Ñˆ                                  â”‚           â”‚
    â”‚    â”‚                                                         â”‚           â”‚
    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
    â”‚                                                                          â”‚
    â”‚    Ğ¢Ğ•ĞšĞ¨Ğ˜Ğ Ğ˜Ğ¨ Ğ ĞĞ™Ğ¥ĞĞ¢Ğ˜:                                                    â”‚
    â”‚    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                    â”‚
    â”‚    â˜‘ ĞšĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Ñ‚ÑÒ“Ñ€Ğ¸ Ğ¶Ğ¾Ğ¹Ğ´Ğ°                                              â”‚
    â”‚    â˜‘ Ğ¢ĞµĞºĞ¸Ñ Ñ‚ÑƒÑ€Ğ¸ÑˆĞ¸ Ñ‚ĞµĞºÑˆĞ¸Ñ€Ğ¸Ğ»Ğ³Ğ°Ğ½                                           â”‚
    â”‚    â˜‘ ÒšÑƒĞ»Ñ„Ğ»Ğ°Ñ€ Ğ±ĞµÑ€Ğº                                                       â”‚
    â”‚    â˜‘ ĞÑ‚Ñ€Ğ¾Ñ„Ğ¸ Ğ±ÑÑˆ                                                         â”‚
    â”‚                                                                          â”‚
    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
    â”‚    â”‚          [ âœ… Ğ¢ĞĞ¡Ğ”Ğ˜ÒšĞ›ĞĞ¨ ]                               â”‚           â”‚
    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
    â”‚                                                                          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â”‚ Manager taps "Ğ¢ĞĞ¡Ğ”Ğ˜ÒšĞ›ĞĞ¨"
                                        â”‚ Photo uploaded
                                        â”‚ Checklist validated
                                        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  SYSTEM PROCESSING                                                       â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                                                                          â”‚
    â”‚    1. Validate checklist complete     âœ“                                  â”‚
    â”‚    2. Save placement photo            âœ“                                  â”‚
    â”‚    3. Create ContainerPosition        âœ“                                  â”‚
    â”‚       â€¢ zone: A                                                          â”‚
    â”‚       â€¢ row: 3                                                           â”‚
    â”‚       â€¢ bay: 15                                                          â”‚
    â”‚       â€¢ tier: 2                                                          â”‚
    â”‚       â€¢ sub_slot: A                                                      â”‚
    â”‚    4. Update ContainerEntry.location  âœ“                                  â”‚
    â”‚       â€¢ location = "A-R03-B15-T2-A"                                      â”‚
    â”‚    5. Update WorkOrder.status         âœ“                                  â”‚
    â”‚       â€¢ COMPLETED                                                        â”‚
    â”‚       â€¢ verification_status = PENDING                                    â”‚
    â”‚    6. Calculate SLA compliance        âœ“                                  â”‚
    â”‚       â€¢ sla_met = true (completed in 47 min)                             â”‚
    â”‚                                                                          â”‚
    â”‚    â†’ TRIGGER STEP 5: Notify Control Room                                â”‚
    â”‚                                                                          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### API Endpoint

```yaml
POST /api/terminal/work-orders/{id}/complete/

Request:
  Content-Type: multipart/form-data

  placement_photo: <binary image data>

Response:
  success: true
  data:
    id: 789
    order_number: "WO-20260116-0023"
    status: "COMPLETED"
    completed_at: "2026-01-16T11:17:00Z"
    sla_met: true
    verification_status: "PENDING"
    container_entry:
      id: 456
      container_number: "MSCU1234567"
      location: "A-R03-B15-T2-A"
    position:
      id: 234
      zone: "A"
      row: 3
      bay: 15
      tier: 2
      sub_slot: "A"
```

---

## 6. Step 5: Operator Receives Confirmation

### Purpose
Control room operator receives Telegram notification that the container has been placed.

### Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   STEP 5: OPERATOR NOTIFICATION                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    SYSTEM                                           CONTROL ROOM
       â”‚                                                  â”‚
       â”‚                                                  â”‚
       â”‚â”€â”€â”€â”€ Work Order COMPLETED â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
       â”‚                                                  â”‚
       â”‚                                                  â”‚
       â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
       â”‚     â”‚       TELEGRAM BOT MESSAGE            â”‚    â”‚
       â”‚     â”‚                                       â”‚    â”‚
       â”‚â”€â”€â”€â”€â”€â”‚  âœ… ĞšĞĞĞ¢Ğ•Ğ™ĞĞ•Ğ  Ğ ĞĞ—ĞœĞ•Ğ©ĞĞ                â”‚â”€â”€â”€â–¶â”‚
       â”‚     â”‚                                       â”‚    â”‚
       â”‚     â”‚  ĞĞ¾Ğ¼ĞµÑ€: `MSCU1234567`                 â”‚    â”‚
       â”‚     â”‚  ĞŸĞ¾Ğ·Ğ¸Ñ†Ğ¸Ñ: `A-R03-B15-T2-A`            â”‚    â”‚
       â”‚     â”‚  ĞœĞµĞ½ĞµĞ´Ğ¶ĞµÑ€: Ivan Petrov                â”‚    â”‚
       â”‚     â”‚                                       â”‚    â”‚
       â”‚     â”‚  â± Ğ’Ñ€ĞµĞ¼Ñ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ: 47 Ğ¼Ğ¸Ğ½          â”‚    â”‚
       â”‚     â”‚  âœ“ SLA Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½                       â”‚    â”‚
       â”‚     â”‚                                       â”‚    â”‚
       â”‚     â”‚  [ğŸ“· ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ñ„Ğ¾Ñ‚Ğ¾]                 â”‚    â”‚
       â”‚     â”‚  [âœ… ĞŸĞ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ´Ğ¸Ñ‚ÑŒ] [âŒ ĞÑˆĞ¸Ğ±ĞºĞ°]         â”‚    â”‚
       â”‚     â”‚                                       â”‚    â”‚
       â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
       â”‚                                                  â”‚
       â”‚                                                  â”‚
       â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                    â”‚                             â”‚
       â”‚                    â–¼                             â”‚
       â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
       â”‚            â”‚ OPERATOR     â”‚                      â”‚
       â”‚            â”‚ CLICKS       â”‚                      â”‚
       â”‚            â”‚ [ĞŸĞ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ´Ğ¸Ñ‚ÑŒ]â”‚                      â”‚
       â”‚            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
       â”‚                   â”‚                              â”‚
       â”‚                   â”‚                              â”‚
       â”‚â—€â”€â”€ POST /verify/ â”€â”˜                              â”‚
       â”‚                                                  â”‚
       â”‚                                                  â”‚
       â”‚â”€â”€ WorkOrder.status = VERIFIED â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
       â”‚                                                  â”‚
       â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
       â”‚     â”‚       TELEGRAM BOT MESSAGE            â”‚    â”‚
       â”‚     â”‚                                       â”‚    â”‚
       â”‚â”€â”€â”€â”€â”€â”‚  âœ… Ğ ĞĞ—ĞœĞ•Ğ©Ğ•ĞĞ˜Ğ• ĞŸĞĞ”Ğ¢Ğ’Ğ•Ğ Ğ–Ğ”Ğ•ĞĞ           â”‚â”€â”€â”€â–¶â”‚ (to Manager)
       â”‚     â”‚                                       â”‚    â”‚
       â”‚     â”‚  `MSCU1234567` â†’ `A-R03-B15-T2-A`     â”‚    â”‚
       â”‚     â”‚                                       â”‚    â”‚
       â”‚     â”‚  Ğ¡Ğ¿Ğ°ÑĞ¸Ğ±Ğ¾ Ğ·Ğ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñƒ! ğŸ‘               â”‚    â”‚
       â”‚     â”‚                                       â”‚    â”‚
       â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
       â”‚                                                  â”‚
```

### Telegram Notification to Control Room

```
âœ… ĞšĞĞĞ¢Ğ•Ğ™ĞĞ•Ğ  Ğ ĞĞ—ĞœĞ•Ğ©ĞĞ

ğŸ“¦ ĞšĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€: `MSCU1234567`
ğŸ“ ĞŸĞ¾Ğ·Ğ¸Ñ†Ğ¸Ñ: `A-R03-B15-T2-A`
ğŸ‘· ĞœĞµĞ½ĞµĞ´Ğ¶ĞµÑ€: Ivan Petrov

ğŸ“ Ğ Ğ°Ğ·Ğ¼ĞµÑ€: 40ft High Cube
âš–ï¸ Ğ’ĞµÑ: 28.5 Ñ‚Ğ¾Ğ½Ğ½
ğŸ“Š Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ: Ğ“Ğ Ğ£Ğ–Ğ•ĞĞ«Ğ™

â± Ğ’Ñ€ĞµĞ¼Ñ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ: 47 Ğ¼Ğ¸Ğ½
âœ“ SLA Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½ (Ğ»Ğ¸Ğ¼Ğ¸Ñ‚: 60 Ğ¼Ğ¸Ğ½)

[ğŸ“· ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ñ„Ğ¾Ñ‚Ğ¾ Ñ€Ğ°Ğ·Ğ¼ĞµÑ‰ĞµĞ½Ğ¸Ñ]
```

### Verification Options

The operator can:

1. **Confirm Correct** (`/api/terminal/work-orders/{id}/verify/`)
   - Sets `verification_status = CORRECT`
   - Sets `status = VERIFIED`
   - Sends success notification to manager

2. **Mark as Incorrect** (`/api/terminal/work-orders/{id}/fail/`)
   - Sets `verification_status = INCORRECT`
   - Sets `status = FAILED`
   - Sends failure notification to manager with notes
   - Manager may need to relocate container

### API Endpoints

```yaml
# Verify placement (success)
POST /api/terminal/work-orders/{id}/verify/

Request:
  is_correct: true
  notes: ""                         # Optional

Response:
  success: true
  data:
    status: "VERIFIED"
    verification_status: "CORRECT"
    verified_at: "2026-01-16T11:20:00Z"

---

# Fail placement (incorrect)
POST /api/terminal/work-orders/{id}/fail/

Request:
  reason: "ĞšĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Ñ€Ğ°Ğ·Ğ¼ĞµÑ‰Ñ‘Ğ½ Ğ² Ğ½ĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾Ğ¼ Ñ€ÑĞ´Ñƒ"

Response:
  success: true
  data:
    status: "FAILED"
    verification_status: "INCORRECT"
    verification_notes: "ĞšĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Ñ€Ğ°Ğ·Ğ¼ĞµÑ‰Ñ‘Ğ½ Ğ² Ğ½ĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾Ğ¼ Ñ€ÑĞ´Ñƒ"
```

---

## 7. Data Models

### Entity Relationship Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           DATA MODEL                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ContainerEntry    â”‚         â”‚   ContainerPosition  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)              â”‚         â”‚ id (PK)              â”‚
â”‚ container_number     â”‚         â”‚ zone                 â”‚
â”‚ size                 â”‚         â”‚ row                  â”‚
â”‚ status               â”‚    1:1  â”‚ bay                  â”‚
â”‚ weight_kg            â”‚â—€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ tier                 â”‚
â”‚ entry_time           â”‚         â”‚ sub_slot             â”‚
â”‚ exit_time            â”‚         â”‚ container_entry (FK) â”‚
â”‚ location (computed)  â”‚         â”‚ auto_assigned        â”‚
â”‚ customer (FK)        â”‚         â”‚ created_at           â”‚
â”‚ recorded_by (FK)     â”‚         â”‚ updated_at           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ 1:N
           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     WorkOrder        â”‚         â”‚      CustomUser      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)              â”‚         â”‚ id (PK)              â”‚
â”‚ order_number         â”‚         â”‚ username             â”‚
â”‚ container_entry (FK) â”‚         â”‚ telegram_id          â”‚
â”‚ status               â”‚    N:1  â”‚ phone                â”‚
â”‚ priority             â”‚â—€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ role                 â”‚
â”‚ target_zone          â”‚         â”‚ is_yard_manager      â”‚
â”‚ target_row           â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ target_bay           â”‚
â”‚ target_tier          â”‚
â”‚ target_sub_slot      â”‚
â”‚ assigned_to (FK)     â”‚
â”‚ created_by (FK)      â”‚
â”‚ sla_deadline         â”‚
â”‚ sla_met              â”‚
â”‚ placement_photo      â”‚
â”‚ verification_status  â”‚
â”‚ verification_notes   â”‚
â”‚ created_at           â”‚
â”‚ assigned_at          â”‚
â”‚ accepted_at          â”‚
â”‚ started_at           â”‚
â”‚ completed_at         â”‚
â”‚ verified_at          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ContainerEntry Model

```python
class ContainerEntry(models.Model):
    """Container on terminal, from entry to exit."""

    container = models.ForeignKey(Container, on_delete=models.PROTECT)

    # Size derived from container or manually set
    SIZE_CHOICES = [
        ('20', '20ft'),
        ('40', '40ft'),
        ('45', '45ft'),
    ]

    STATUS_CHOICES = [
        ('LADEN', 'Laden (Loaded)'),
        ('EMPTY', 'Empty'),
    ]

    TRANSPORT_CHOICES = [
        ('TRUCK', 'Truck'),
        ('WAGON', 'Railway Wagon'),
        ('TRAIN', 'Train'),
    ]

    status = models.CharField(max_length=10, choices=STATUS_CHOICES)
    transport_type = models.CharField(max_length=10, choices=TRANSPORT_CHOICES)
    weight_kg = models.PositiveIntegerField(null=True, blank=True)

    entry_time = models.DateTimeField(auto_now_add=True)
    exit_time = models.DateTimeField(null=True, blank=True)

    # Computed location string (set when position assigned)
    location = models.CharField(max_length=20, null=True, blank=True)

    customer = models.ForeignKey(
        Company,
        on_delete=models.SET_NULL,
        null=True,
        blank=True
    )
    recorded_by = models.ForeignKey(
        settings.AUTH_USER_MODEL,
        on_delete=models.SET_NULL,
        null=True
    )

    class Meta:
        indexes = [
            models.Index(fields=['location']),
            models.Index(fields=['entry_time']),
            models.Index(fields=['status']),
        ]
```

### ContainerPosition Model

```python
class ContainerPosition(models.Model):
    """Exact 3D position of container in yard."""

    container_entry = models.OneToOneField(
        ContainerEntry,
        on_delete=models.CASCADE,
        related_name='position'
    )

    zone = models.CharField(max_length=1)  # A-E
    row = models.PositiveSmallIntegerField()  # 1-10
    bay = models.PositiveSmallIntegerField()  # 1-10
    tier = models.PositiveSmallIntegerField()  # 1-4
    sub_slot = models.CharField(max_length=1, default='A')  # A or B

    auto_assigned = models.BooleanField(default=False)
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)

    class Meta:
        unique_together = ['zone', 'row', 'bay', 'tier', 'sub_slot']
        indexes = [
            models.Index(fields=['zone', 'row']),
        ]

    @property
    def coordinate(self) -> str:
        """Return formatted coordinate string."""
        return f"{self.zone}-R{self.row:02d}-B{self.bay:02d}-T{self.tier}-{self.sub_slot}"
```

### WorkOrder Model

```python
class WorkOrder(models.Model):
    """Placement task from creation to verification."""

    STATUS_CHOICES = [
        ('PENDING', 'Pending'),
        ('ASSIGNED', 'Assigned'),
        ('ACCEPTED', 'Accepted'),
        ('IN_PROGRESS', 'In Progress'),
        ('COMPLETED', 'Completed'),
        ('VERIFIED', 'Verified'),
        ('FAILED', 'Failed'),
    ]

    PRIORITY_CHOICES = [
        ('LOW', 'Low'),
        ('MEDIUM', 'Medium'),
        ('HIGH', 'High'),
        ('URGENT', 'Urgent'),
    ]

    VERIFICATION_CHOICES = [
        ('PENDING', 'Pending'),
        ('CORRECT', 'Correct'),
        ('INCORRECT', 'Incorrect'),
    ]

    # Identity
    order_number = models.CharField(max_length=20, unique=True)

    # What
    container_entry = models.ForeignKey(
        ContainerEntry,
        on_delete=models.CASCADE,
        related_name='work_orders'
    )

    # Where (target position)
    target_zone = models.CharField(max_length=1)
    target_row = models.PositiveSmallIntegerField()
    target_bay = models.PositiveSmallIntegerField()
    target_tier = models.PositiveSmallIntegerField()
    target_sub_slot = models.CharField(max_length=1, default='A')

    # Status
    status = models.CharField(max_length=20, choices=STATUS_CHOICES, default='PENDING')
    priority = models.CharField(max_length=10, choices=PRIORITY_CHOICES, default='MEDIUM')

    # Who
    created_by = models.ForeignKey(
        settings.AUTH_USER_MODEL,
        on_delete=models.SET_NULL,
        null=True,
        related_name='created_work_orders'
    )
    assigned_to = models.ForeignKey(
        settings.AUTH_USER_MODEL,
        on_delete=models.SET_NULL,
        null=True,
        blank=True,
        related_name='assigned_work_orders'
    )

    # Timestamps
    created_at = models.DateTimeField(auto_now_add=True)
    assigned_at = models.DateTimeField(null=True, blank=True)
    accepted_at = models.DateTimeField(null=True, blank=True)
    started_at = models.DateTimeField(null=True, blank=True)
    completed_at = models.DateTimeField(null=True, blank=True)
    verified_at = models.DateTimeField(null=True, blank=True)

    # SLA
    sla_deadline = models.DateTimeField()
    sla_met = models.BooleanField(null=True, blank=True)

    # Verification
    placement_photo = models.ImageField(
        upload_to='placement_photos/',
        null=True,
        blank=True
    )
    verification_status = models.CharField(
        max_length=20,
        choices=VERIFICATION_CHOICES,
        default='PENDING'
    )
    verification_notes = models.TextField(blank=True)

    class Meta:
        ordering = ['-created_at']
        indexes = [
            models.Index(fields=['status', 'assigned_to']),
            models.Index(fields=['created_at']),
        ]

    @property
    def target_coordinate(self) -> str:
        """Return formatted target coordinate."""
        return f"{self.target_zone}-R{self.target_row:02d}-B{self.target_bay:02d}-T{self.target_tier}-{self.target_sub_slot}"
```

---

## 8. API Endpoints Summary

### Container Entry

| Method | Endpoint | Description |
|--------|----------|-------------|
| `POST` | `/api/terminal/entries/` | Create container entry |
| `GET` | `/api/terminal/entries/` | List entries (with filters) |
| `GET` | `/api/terminal/entries/{id}/` | Get entry details |
| `PATCH` | `/api/terminal/entries/{id}/` | Update entry |

### Placement

| Method | Endpoint | Description |
|--------|----------|-------------|
| `GET` | `/api/terminal/placement/layout/` | Get full terminal layout |
| `GET` | `/api/terminal/placement/unplaced/` | Get unplaced containers |
| `POST` | `/api/terminal/placement/suggest/` | Get position suggestions |
| `POST` | `/api/terminal/placement/validate/` | Validate position |
| `POST` | `/api/terminal/placement/assign/` | Assign container to position |

### Work Orders

| Method | Endpoint | Description |
|--------|----------|-------------|
| `POST` | `/api/terminal/work-orders/` | Create work order |
| `GET` | `/api/terminal/work-orders/` | List work orders |
| `GET` | `/api/terminal/work-orders/{id}/` | Get work order details |
| `POST` | `/api/terminal/work-orders/{id}/assign/` | Assign to manager |
| `POST` | `/api/terminal/work-orders/{id}/accept/` | Manager accepts |
| `POST` | `/api/terminal/work-orders/{id}/start/` | Manager starts |
| `POST` | `/api/terminal/work-orders/{id}/complete/` | Manager completes |
| `POST` | `/api/terminal/work-orders/{id}/verify/` | Operator verifies |
| `POST` | `/api/terminal/work-orders/{id}/fail/` | Mark as failed |
| `GET` | `/api/terminal/work-orders/my-orders/` | Manager's orders |

---

## 9. Telegram Notification Templates

### To Control Room

#### New Container Entry
```
ğŸ“¦ ĞĞĞ’Ğ«Ğ™ ĞšĞĞĞ¢Ğ•Ğ™ĞĞ•Ğ  ĞĞ Ğ¢Ğ•Ğ ĞœĞ˜ĞĞĞ›Ğ•

ĞĞ¾Ğ¼ĞµÑ€: `{container_number}`
Ğ Ğ°Ğ·Ğ¼ĞµÑ€: {size}ft {type}
Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ: {status_ru} ({weight}Ñ‚)
Ğ¢Ñ€Ğ°Ğ½ÑĞ¿Ğ¾Ñ€Ñ‚: {transport_ru}

â³ ĞĞ¶Ğ¸Ğ´Ğ°ĞµÑ‚ Ñ€Ğ°Ğ·Ğ¼ĞµÑ‰ĞµĞ½Ğ¸Ñ

[ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ]
```

#### Container Placed
```
âœ… ĞšĞĞĞ¢Ğ•Ğ™ĞĞ•Ğ  Ğ ĞĞ—ĞœĞ•Ğ©ĞĞ

ğŸ“¦ ĞšĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€: `{container_number}`
ğŸ“ ĞŸĞ¾Ğ·Ğ¸Ñ†Ğ¸Ñ: `{position}`
ğŸ‘· ĞœĞµĞ½ĞµĞ´Ğ¶ĞµÑ€: {manager_name}

ğŸ“ Ğ Ğ°Ğ·Ğ¼ĞµÑ€: {size}ft {type}
âš–ï¸ Ğ’ĞµÑ: {weight}Ñ‚

â± Ğ’Ñ€ĞµĞ¼Ñ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ: {duration_min} Ğ¼Ğ¸Ğ½
{sla_status}

[ğŸ“· ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ñ„Ğ¾Ñ‚Ğ¾]
```

#### SLA Warning
```
âš ï¸ Ğ’ĞĞ˜ĞœĞĞĞ˜Ğ•: SLA Ğ‘Ğ›Ğ˜Ğ—ĞšĞ Ğš Ğ¡Ğ ĞĞšĞ£

ğŸ“‹ ĞĞ°Ñ€ÑĞ´: `{order_number}`
ğŸ“¦ ĞšĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€: `{container_number}`
ğŸ“ Ğ¦ĞµĞ»ÑŒ: `{position}`
ğŸ‘· ĞœĞµĞ½ĞµĞ´Ğ¶ĞµÑ€: {manager_name}

â± ĞÑÑ‚Ğ°Ğ»Ğ¾ÑÑŒ: {remaining_min} Ğ¼Ğ¸Ğ½

[ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑ]
```

### To Manager

#### New Work Order
```
ğŸ“‹ ĞĞĞ’Ğ«Ğ™ ĞĞĞ Ğ¯Ğ” ĞĞ Ğ ĞĞ—ĞœĞ•Ğ©Ğ•ĞĞ˜Ğ•

{priority_emoji} ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚: {priority_ru}

ğŸ“¦ `{container_number}`
ğŸ“ â†’ `{position}`

ğŸ“ {size}ft | {status_ru}
â± {deadline_min} Ğ¼Ğ¸Ğ½ÑƒÑ‚

[ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ]
```

#### Placement Verified
```
âœ… Ğ ĞĞ—ĞœĞ•Ğ©Ğ•ĞĞ˜Ğ• ĞŸĞĞ”Ğ¢Ğ’Ğ•Ğ Ğ–Ğ”Ğ•ĞĞ

ğŸ“¦ `{container_number}` â†’ `{position}`

Ğ¡Ğ¿Ğ°ÑĞ¸Ğ±Ğ¾ Ğ·Ğ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñƒ! ğŸ‘

â± Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¾ Ğ·Ğ° {duration_min} Ğ¼Ğ¸Ğ½
```

#### Placement Failed
```
âŒ Ğ ĞĞ—ĞœĞ•Ğ©Ğ•ĞĞ˜Ğ• ĞĞ• ĞŸĞĞ”Ğ¢Ğ’Ğ•Ğ Ğ–Ğ”Ğ•ĞĞ

ğŸ“¦ `{container_number}` â†’ `{position}`

ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°: {reason}

ĞĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ Ğ¿ĞµÑ€ĞµĞ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ñ.

[ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ½Ğ°Ñ€ÑĞ´]
```

---

## 10. Error Handling

### Business Logic Errors

| Code | Russian Message | When |
|------|-----------------|------|
| `INVALID_CONTAINER_FORMAT` | ĞĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ½Ğ¾Ğ¼ĞµÑ€Ğ° ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ° | Container number doesn't match ISO 6346 |
| `CONTAINER_ALREADY_ON_TERMINAL` | ĞšĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ ÑƒĞ¶Ğµ Ğ½Ğ° Ñ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ğ»Ğµ | Duplicate entry attempt |
| `INVALID_ROW_FOR_SIZE` | Ğ ÑĞ´ Ğ½Ğµ ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ñƒ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ° | 40ft in rows 6-10 or 20ft in rows 1-5 |
| `SIZE_INCOMPATIBLE` | ĞĞµĞ»ÑŒĞ·Ñ ÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ÑŒ 40ft Ğ½Ğ° 20ft | Attempting to stack 40ft on single 20ft |
| `WEIGHT_INCOMPATIBLE` | ĞĞµĞ»ÑŒĞ·Ñ ÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ñ‹Ğ¹ Ğ½Ğ° Ğ¿ÑƒÑÑ‚Ğ¾Ğ¹ | LADEN on EMPTY |
| `NO_SUPPORT_BELOW` | ĞĞµÑ‚ Ğ¾Ğ¿Ğ¾Ñ€Ñ‹ ÑĞ½Ğ¸Ğ·Ñƒ | Tier > 1 without container below |
| `MAX_HEIGHT_EXCEEDED` | ĞŸÑ€ĞµĞ²Ñ‹ÑˆĞµĞ½Ğ° Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ²Ñ‹ÑĞ¾Ñ‚Ğ° | Tier > 4 |
| `POSITION_OCCUPIED` | ĞŸĞ¾Ğ·Ğ¸Ñ†Ğ¸Ñ ÑƒĞ¶Ğµ Ğ·Ğ°Ğ½ÑÑ‚Ğ° | Slot has container |
| `WORK_ORDER_EXISTS` | ĞĞ°Ñ€ÑĞ´ Ğ½Ğ° ÑÑ‚Ğ¾Ñ‚ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ ÑƒĞ¶Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚ | Active work order for container |
| `INVALID_STATUS_TRANSITION` | ĞĞµĞ´Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ğ¼Ñ‹Ğ¹ Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ° | e.g., PENDING â†’ COMPLETED |

### Response Format

```json
{
  "success": false,
  "error": {
    "code": "INVALID_ROW_FOR_SIZE",
    "message": "Ğ ÑĞ´ Ğ½Ğµ ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ñƒ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°",
    "details": {
      "container_size": "40",
      "target_row": 7,
      "allowed_rows": [1, 2, 3, 4, 5]
    }
  }
}
```

---

## 11. Implementation Checklist

### Phase 1: Backend Core (Week 1-2)

- [ ] **Models**
  - [ ] WorkOrder model with all fields
  - [ ] WorkOrder migrations
  - [ ] Update ContainerEntry with location field

- [ ] **Services**
  - [ ] `WorkOrderService` with state machine
  - [ ] Update `PlacementService.assign_position()` to work with WorkOrder
  - [ ] Update `TelegramNotificationService` with new templates

- [ ] **API Endpoints**
  - [ ] WorkOrder CRUD endpoints
  - [ ] `/accept/`, `/start/`, `/complete/`, `/verify/`, `/fail/`
  - [ ] `/my-orders/` for manager

- [ ] **Telegram Notifications**
  - [ ] New container entry â†’ Control room
  - [ ] Work order assigned â†’ Manager
  - [ ] Placement complete â†’ Control room
  - [ ] SLA warning â†’ Control room + Manager

### Phase 2: Telegram Mini App (Week 3-4)

- [ ] **Types**
  - [ ] `types/placement.ts` with all interfaces

- [ ] **Context/Hooks**
  - [ ] `PlacementContext` with state management
  - [ ] `useYardLayout` hook

- [ ] **Pages**
  - [ ] `WorkOrdersPage` - List of orders
  - [ ] `PlacementDetailPage` - Order details + maps
  - [ ] `PlacementConfirmPage` - Photo + checklist

- [ ] **Components**
  - [ ] `YardGrid` - 2D top-down view
  - [ ] `RowSideView` - Side tier view
  - [ ] `WorkOrderCard` - Order list item
  - [ ] `PlacementInfo` - Container details
  - [ ] `PlacementChecklist` - Verification checklist
  - [ ] `CountdownTimer` - SLA countdown

### Phase 3: Vue Dashboard Updates (Week 5)

- [ ] **Work Order Panel**
  - [ ] List of pending work orders
  - [ ] Create work order from unplaced container
  - [ ] Assign manager dropdown

- [ ] **Verification Panel**
  - [ ] List of completed orders awaiting verification
  - [ ] View placement photo
  - [ ] Verify/Fail buttons

### Phase 4: Testing & Documentation (Week 6)

- [ ] **Backend Tests**
  - [ ] WorkOrderService unit tests
  - [ ] API endpoint integration tests
  - [ ] State machine transition tests

- [ ] **Frontend Tests**
  - [ ] Component unit tests
  - [ ] E2E tests for critical flows

- [ ] **Documentation**
  - [ ] API documentation (Swagger/OpenAPI)
  - [ ] User guide for operators
  - [ ] User guide for managers

---

## Appendix: Quick Reference

### Status Flow Summary

```
Entry â†’ Unplaced â†’ Work Order Created â†’ Assigned â†’ Accepted â†’ In Progress â†’ Completed â†’ Verified
  â†“                       â†“                                                       â†“
(Step 1)              (Step 2-3)                 (Step 4)                    (Step 5)
```

### Notification Summary

| Event | Recipients | Channel |
|-------|------------|---------|
| Container enters | Control Room | Telegram |
| Work order created | Assigned Manager | Telegram |
| Manager accepts | - | (Internal status update) |
| Placement complete | Control Room | Telegram |
| Placement verified | Manager | Telegram |
| SLA warning | Control Room + Manager | Telegram |

### File Locations

| Component | Path |
|-----------|------|
| Work Order Model | `backend/apps/terminal_operations/models.py` |
| Work Order Service | `backend/apps/terminal_operations/services/work_order_service.py` |
| Placement Service | `backend/apps/terminal_operations/services/placement_service.py` |
| Notification Service | `backend/apps/terminal_operations/services/telegram_notification_service.py` |
| Work Order Views | `backend/apps/terminal_operations/views.py` |
| Mini App Work Orders | `telegram-miniapp/src/pages/WorkOrdersPage/` |
| Mini App Placement | `telegram-miniapp/src/pages/PlacementDetailPage/` |
| Yard Grid Component | `telegram-miniapp/src/components/YardMap/` |

---

> **Document Version:** 2.0
> **Last Updated:** January 2026
> **Key Change:** Simplified notification architecture using Telegram for all parties (no WebSocket)
